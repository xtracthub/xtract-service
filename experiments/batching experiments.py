
import time
from statistics import mean

from funcx.sdk.client import FuncXClient
from fair_research_login import NativeClient
import random

fxc = FuncXClient()

image_func = 'bae46e53-c97e-444f-b837-857449b58e2c'
freetext_func = '5bbc3c6b-13ae-4781-b855-df07d1209f32'
matio_func = '647a78e3-6dc6-4282-8ce2-4468d2036d55'
sampler_func ='6a392b65-4b02-48fc-bdb4-29f439d6f531'

matio_file = '/MDF/mdf_connect/prod/data/au_sr_polymorphism_v1/Au144_MD6341surface1.xyz'
image_file = '/MDF/mdf_connect/prod/data/larsonnataliem_exsitu_xct_beds_v1.1/data/Seg/Regular/20160831_143347_228p1_0p97cm_dry_17keV_1025im_500ex_7.h5/Registered/RegularWoPR/Reg_0075.tif'
sampler_file = '/MDF/mdf_connect/prod/data/mdr_item_1061_v1/2015-07-15-AgedBar-Round2/AgedBar-R2-19.TRA'
freetext_file = '/MDF/mdf_connect/prod/data/ab_initio_solute_database_v1-1/data/BCC_solute_MoSi_20151020T102746/neb_vac2-vac4_opt/README_manual'


def get_headers():

    client = NativeClient(client_id='7414f0b4-7d05-4bb6-bb00-076fa3f17cf5')
    tokens = client.login(
        requested_scopes=['https://auth.globus.org/scopes/56ceac29-e98a-440a-a594-b41e7a084b62/all'])
    auth_token = tokens["petrel_https_server"]['access_token']
    headers = {'Authorization': f'Bearer {auth_token}'}

    return headers


def warm_containers(ep_id, cont_type, num_run, headers):
    # TODO: 1 minute sleep.

    location = '039706667969.dkr.ecr.us-east-1.amazonaws.com/xtract-{}'.format(cont_type)
    description = 'Xtract image types container'
    container_type = 'docker'
    name = "xtract/{}".format(cont_type)
    container_uuid = fxc.register_container(name, location, description, container_type)

    func = """
def sleep_60(event):
    import time
    # time.sleep(60)
    return("Done")
"""
# {'details': {'result': {'metadata': [{'extract time': 0.011764049530029297, 'file_id': 'this-is-my-file-id', 'matio': {'ase': {'cell': [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], 'chemical_formula': 'Au144S60', 'ctime': 19.701231877966144, 'mtime': 19.701231877966144, 'numbers': [79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16], 'pbc': [False, False, False], 'positions': [[0.0, 0.0, -4.2675], [0.0, 0.0, -1.4225], [0.0, 0.0, 1.4225], [0.0, 0.0, 4.2675], [2.46384227377, 0.0, -5.69], [0.761369134053, 2.34325324959, -5.69], [-1.99329027094, 1.44821015249, -5.69], [-1.99329027094, -1.44821015249, -5.69], [0.761369134053, -2.34325324959, -5.69], [2.46384227377, 0.0, -2.845], [0.761369134053, 2.34325324959, -2.845], [-1.99329027094, 1.44821015249, -2.845], [-1.99329027094, -1.44821015249, -2.845], [0.761369134053, -2.34325324959, -2.845], [2.46384227377, 0.0, 0.0], [0.761369134053, 2.34325324959, 0.0], [-1.99329027094, 1.44821015249, 0.0], [-1.99329027094, -1.44821015249, 0.0], [0.761369134053, -2.34325324959, 0.0], [2.46384227377, 0.0, 2.845], [0.761369134053, 2.34325324959, 2.845], [-1.99329027094, 1.44821015249, 2.845], [-1.99329027094, -1.44821015249, 2.845], [0.761369134053, -2.34325324959, 2.845], [2.46384227377, 0.0, 5.69], [0.761369134053, 2.34325324959, 5.69], [-1.99329027094, 1.44821015249, 5.69], [-1.99329027094, -1.44821015249, 5.69], [0.761369134053, -2.34325324959, 5.69], [4.92768454753, 0.0, -4.2675], [3.22521140782, 2.34325324959, -4.2675], [1.52273826811, 4.68650649918, -4.2675], [-1.23192113688, 3.79146340208, -4.2675], [-3.98658054187, 2.89642030499, -4.2675], [-3.98658054187, 6.31716901012e-16, -4.2675], [-3.98658054187, -2.89642030499, -4.2675], [-1.23192113688, -3.79146340208, -4.2675], [1.52273826811, -4.68650649918, -4.2675], [3.22521140782, -2.34325324959, -4.2675], [4.92768454753, 0.0, -1.4225], [3.22521140782, 2.34325324959, -1.4225], [1.52273826811, 4.68650649918, -1.4225], [-1.23192113688, 3.79146340208, -1.4225], [-3.98658054187, 2.89642030499, -1.4225], [-3.98658054187, 6.31716901012e-16, -1.4225], [-3.98658054187, -2.89642030499, -1.4225], [-1.23192113688, -3.79146340208, -1.4225], [1.52273826811, -4.68650649918, -1.4225], [3.22521140782, -2.34325324959, -1.4225], [4.92768454753, 0.0, 1.4225], [3.22521140782, 2.34325324959, 1.4225], [1.52273826811, 4.68650649918, 1.4225], [-1.23192113688, 3.79146340208, 1.4225], [-3.98658054187, 2.89642030499, 1.4225], [-3.98658054187, 6.31716901012e-16, 1.4225], [-3.98658054187, -2.89642030499, 1.4225], [-1.23192113688, -3.79146340208, 1.4225], [1.52273826811, -4.68650649918, 1.4225], [3.22521140782, -2.34325324959, 1.4225], [4.92768454753, 0.0, 4.2675], [3.22521140782, 2.34325324959, 4.2675], [1.52273826811, 4.68650649918, 4.2675], [-1.23192113688, 3.79146340208, 4.2675], [-3.98658054187, 2.89642030499, 4.2675], [-3.98658054187, 6.31716901012e-16, 4.2675], [-3.98658054187, -2.89642030499, 4.2675], [-1.23192113688, -3.79146340208, 4.2675], [1.52273826811, -4.68650649918, 4.2675], [3.22521140782, -2.34325324959, 4.2675], [7.3915268213, 0.0, -2.845], [5.68905368159, 2.34325324959, -2.845], [3.98658054187, 4.68650649918, -2.845], [2.28410740216, 7.02975974877, -2.845], [-0.47055200283, 6.13471665167, -2.845], [-3.22521140782, 5.23967355458, -2.845], [-5.97987081281, 4.34463045748, -2.845], [-5.97987081281, 1.44821015249, -2.845], [-5.97987081281, -1.44821015249, -2.845], [-5.97987081281, -4.34463045748, -2.845], [-3.22521140782, -5.23967355458, -2.845], [-0.47055200283, -6.13471665167, -2.845], [2.28410740216, -7.02975974877, -2.845], [3.98658054187, -4.68650649918, -2.845], [5.68905368159, -2.34325324959, -2.845], [7.3915268213, 0.0, 0.0], [5.68905368159, 2.34325324959, 0.0], [3.98658054187, 4.68650649918, 0.0], [2.28410740216, 7.02975974877, 0.0], [-0.47055200283, 6.13471665167, 0.0], [-3.22521140782, 5.23967355458, 0.0], [-5.97987081281, 4.34463045748, 0.0], [-5.97987081281, 1.44821015249, 0.0], [-5.97987081281, -1.44821015249, 0.0], [-5.97987081281, -4.34463045748, 0.0], [-3.22521140782, -5.23967355458, 0.0], [-0.47055200283, -6.13471665167, 0.0], [2.28410740216, -7.02975974877, 0.0], [3.98658054187, -4.68650649918, 0.0], [5.68905368159, -2.34325324959, 0.0], [7.3915268213, 0.0, 2.845], [5.68905368159, 2.34325324959, 2.845], [3.98658054187, 4.68650649918, 2.845], [2.28410740216, 7.02975974877, 2.845], [-0.47055200283, 6.13471665167, 2.845], [-3.22521140782, 5.23967355458, 2.845], [-5.97987081281, 4.34463045748, 2.845], [-5.97987081281, 1.44821015249, 2.845], [-5.97987081281, -1.44821015249, 2.845], [-5.97987081281, -4.34463045748, 2.845], [-3.22521140782, -5.23967355458, 2.845], [-0.47055200283, -6.13471665167, 2.845], [2.28410740216, -7.02975974877, 2.845], [3.98658054187, -4.68650649918, 2.845], [5.68905368159, -2.34325324959, 2.845], [-5.2672, 1.4482, 6.062], [-7.0715, 0.73071, 4.7744], [-3.4629, 2.1657, 7.3496], [-5.2672, -1.4482, -6.062], [-3.4629, -2.1657, -7.3496], [-7.0715, -0.73071, -4.7744], [-8.2834, 2.8964, 1.4225], [-8.2834, 1.1022, -0.069389], [-8.2834, 4.6906, 2.9144], [-8.2834, 2.8964, -1.4225], [-8.2834, 1.1022, -2.9144], [-8.2834, 4.6906, 0.069389], [-8.2834, -2.8964, 1.4225], [-8.2834, -4.6906, -0.069389], [-8.2834, -1.1022, 2.9144], [-8.2834, -2.8964, -1.4225], [-8.2834, -4.6906, -2.9144], [-8.2834, -1.1022, 0.069389], [-3.005, -4.5619, 6.062], [-2.8802, -6.4996, 4.7744], [-3.1298, -2.6242, 7.3496], [-0.25033, -5.4569, -6.062], [0.98961, -3.9627, -7.3496], [-1.4903, -6.9512, -4.7744], [-5.3144, -6.983, 1.4225], [-3.608, -7.5374, -0.069389], [-7.0208, -6.4285, 2.9144], [-5.3144, -6.983, -1.4225], [-3.608, -7.5374, -2.9144], [-7.0208, -6.4285, 0.069389], [0.19494, -8.7731, 1.4225], [1.9013, -9.3275, -0.069389], [-1.5114, -8.2186, 2.9144], [0.19494, -8.7731, -1.4225], [1.9013, -9.3275, -2.9144], [-1.5114, -8.2186, 0.069389], [3.41, -4.2676, 6.062], [5.2915, -4.7477, 4.7744], [1.5286, -3.7876, 7.3496], [5.1125, -1.9244, -6.062], [4.0745, -0.28336, -7.3496], [6.1505, -3.5654, -4.7744], [4.999, -7.2121, 1.4225], [6.0536, -5.7606, -0.069389], [3.9444, -8.6637, 2.9144], [4.999, -7.2121, -1.4225], [6.0536, -5.7606, -2.9144], [3.9444, -8.6637, 0.069389], [8.4039, -2.5256, 1.4225], [9.4585, -1.0741, -0.069389], [7.3493, -3.9772, 2.9144], [8.4039, -2.5256, -1.4225], [9.4585, -1.0741, -2.9144], [7.3493, -3.9772, 0.069389], [5.1125, 1.9244, 6.062], [6.1505, 3.5654, 4.7744], [4.0745, 0.28336, 7.3496], [3.41, 4.2676, -6.062], [1.5286, 3.7876, -7.3496], [5.2915, 4.7477, -4.7744], [8.4039, 2.5256, 1.4225], [7.3493, 3.9772, -0.069389], [9.4585, 1.0741, 2.9144], [8.4039, 2.5256, -1.4225], [7.3493, 3.9772, -2.9144], [9.4585, 1.0741, 0.069389], [4.999, 7.2121, -1.4225], [3.9444, 8.6637, -2.9144], [6.0536, 5.7606, 0.069389], [4.999, 7.2121, 1.4225], [3.9444, 8.6637, -0.069389], [6.0536, 5.7606, 2.9144], [-0.25033, 5.4569, 6.062], [-1.4903, 6.9512, 4.7744], [0.98961, 3.9627, 7.3496], [-3.005, 4.5619, -6.062], [-3.1298, 2.6242, -7.3496], [-2.8802, 6.4996, -4.7744], [0.19494, 8.7731, 1.4225], [-1.5114, 8.2186, -0.069389], [1.9013, 9.3275, 2.9144], [0.19494, 8.7731, -1.4225], [-1.5114, 8.2186, -2.9144], [1.9013, 9.3275, 0.069389], [-5.3144, 6.983, -1.4225], [-7.0208, 6.4285, -2.9144], [-3.608, 7.5374, 0.069389], [-5.3144, 6.983, 1.4225], [-7.0208, 6.4285, -0.069389], [-3.608, 7.5374, 2.9144]], 'unique_id': '73a5dc442260269ffbf1e53ea756c344', 'user': None}}, 'trans_time': 0.36760497093200684}, {'extract time': 0.011778116226196289, 'file_id': 'this-is-my-file-id', 'matio': {'ase': {'cell': [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], 'chemical_formula': 'Au144S60', 'ctime': 19.701231888208287, 'mtime': 19.701231888208287, 'numbers': [79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16], 'pbc': [False, False, False], 'positions': [[0.0, 0.0, -4.2675], [0.0, 0.0, -1.4225], [0.0, 0.0, 1.4225], [0.0, 0.0, 4.2675], [2.46384227377, 0.0, -5.69], [0.761369134053, 2.34325324959, -5.69], [-1.99329027094, 1.44821015249, -5.69], [-1.99329027094, -1.44821015249, -5.69], [0.761369134053, -2.34325324959, -5.69], [2.46384227377, 0.0, -2.845], [0.761369134053, 2.34325324959, -2.845], [-1.99329027094, 1.44821015249, -2.845], [-1.99329027094, -1.44821015249, -2.845], [0.761369134053, -2.34325324959, -2.845], [2.46384227377, 0.0, 0.0], [0.761369134053, 2.34325324959, 0.0], [-1.99329027094, 1.44821015249, 0.0], [-1.99329027094, -1.44821015249, 0.0], [0.761369134053, -2.34325324959, 0.0], [2.46384227377, 0.0, 2.845], [0.761369134053, 2.34325324959, 2.845], [-1.99329027094, 1.44821015249, 2.845], [-1.99329027094, -1.44821015249, 2.845], [0.761369134053, -2.34325324959, 2.845], [2.46384227377, 0.0, 5.69], [0.761369134053, 2.34325324959, 5.69], [-1.99329027094, 1.44821015249, 5.69], [-1.99329027094, -1.44821015249, 5.69], [0.761369134053, -2.34325324959, 5.69], [4.92768454753, 0.0, -4.2675], [3.22521140782, 2.34325324959, -4.2675], [1.52273826811, 4.68650649918, -4.2675], [-1.23192113688, 3.79146340208, -4.2675], [-3.98658054187, 2.89642030499, -4.2675], [-3.98658054187, 6.31716901012e-16, -4.2675], [-3.98658054187, -2.89642030499, -4.2675], [-1.23192113688, -3.79146340208, -4.2675], [1.52273826811, -4.68650649918, -4.2675], [3.22521140782, -2.34325324959, -4.2675], [4.92768454753, 0.0, -1.4225], [3.22521140782, 2.34325324959, -1.4225], [1.52273826811, 4.68650649918, -1.4225], [-1.23192113688, 3.79146340208, -1.4225], [-3.98658054187, 2.89642030499, -1.4225], [-3.98658054187, 6.31716901012e-16, -1.4225], [-3.98658054187, -2.89642030499, -1.4225], [-1.23192113688, -3.79146340208, -1.4225], [1.52273826811, -4.68650649918, -1.4225], [3.22521140782, -2.34325324959, -1.4225], [4.92768454753, 0.0, 1.4225], [3.22521140782, 2.34325324959, 1.4225], [1.52273826811, 4.68650649918, 1.4225], [-1.23192113688, 3.79146340208, 1.4225], [-3.98658054187, 2.89642030499, 1.4225], [-3.98658054187, 6.31716901012e-16, 1.4225], [-3.98658054187, -2.89642030499, 1.4225], [-1.23192113688, -3.79146340208, 1.4225], [1.52273826811, -4.68650649918, 1.4225], [3.22521140782, -2.34325324959, 1.4225], [4.92768454753, 0.0, 4.2675], [3.22521140782, 2.34325324959, 4.2675], [1.52273826811, 4.68650649918, 4.2675], [-1.23192113688, 3.79146340208, 4.2675], [-3.98658054187, 2.89642030499, 4.2675], [-3.98658054187, 6.31716901012e-16, 4.2675], [-3.98658054187, -2.89642030499, 4.2675], [-1.23192113688, -3.79146340208, 4.2675], [1.52273826811, -4.68650649918, 4.2675], [3.22521140782, -2.34325324959, 4.2675], [7.3915268213, 0.0, -2.845], [5.68905368159, 2.34325324959, -2.845], [3.98658054187, 4.68650649918, -2.845], [2.28410740216, 7.02975974877, -2.845], [-0.47055200283, 6.13471665167, -2.845], [-3.22521140782, 5.23967355458, -2.845], [-5.97987081281, 4.34463045748, -2.845], [-5.97987081281, 1.44821015249, -2.845], [-5.97987081281, -1.44821015249, -2.845], [-5.97987081281, -4.34463045748, -2.845], [-3.22521140782, -5.23967355458, -2.845], [-0.47055200283, -6.13471665167, -2.845], [2.28410740216, -7.02975974877, -2.845], [3.98658054187, -4.68650649918, -2.845], [5.68905368159, -2.34325324959, -2.845], [7.3915268213, 0.0, 0.0], [5.68905368159, 2.34325324959, 0.0], [3.98658054187, 4.68650649918, 0.0], [2.28410740216, 7.02975974877, 0.0], [-0.47055200283, 6.13471665167, 0.0], [-3.22521140782, 5.23967355458, 0.0], [-5.97987081281, 4.34463045748, 0.0], [-5.97987081281, 1.44821015249, 0.0], [-5.97987081281, -1.44821015249, 0.0], [-5.97987081281, -4.34463045748, 0.0], [-3.22521140782, -5.23967355458, 0.0], [-0.47055200283, -6.13471665167, 0.0], [2.28410740216, -7.02975974877, 0.0], [3.98658054187, -4.68650649918, 0.0], [5.68905368159, -2.34325324959, 0.0], [7.3915268213, 0.0, 2.845], [5.68905368159, 2.34325324959, 2.845], [3.98658054187, 4.68650649918, 2.845], [2.28410740216, 7.02975974877, 2.845], [-0.47055200283, 6.13471665167, 2.845], [-3.22521140782, 5.23967355458, 2.845], [-5.97987081281, 4.34463045748, 2.845], [-5.97987081281, 1.44821015249, 2.845], [-5.97987081281, -1.44821015249, 2.845], [-5.97987081281, -4.34463045748, 2.845], [-3.22521140782, -5.23967355458, 2.845], [-0.47055200283, -6.13471665167, 2.845], [2.28410740216, -7.02975974877, 2.845], [3.98658054187, -4.68650649918, 2.845], [5.68905368159, -2.34325324959, 2.845], [-5.2672, 1.4482, 6.062], [-7.0715, 0.73071, 4.7744], [-3.4629, 2.1657, 7.3496], [-5.2672, -1.4482, -6.062], [-3.4629, -2.1657, -7.3496], [-7.0715, -0.73071, -4.7744], [-8.2834, 2.8964, 1.4225], [-8.2834, 1.1022, -0.069389], [-8.2834, 4.6906, 2.9144], [-8.2834, 2.8964, -1.4225], [-8.2834, 1.1022, -2.9144], [-8.2834, 4.6906, 0.069389], [-8.2834, -2.8964, 1.4225], [-8.2834, -4.6906, -0.069389], [-8.2834, -1.1022, 2.9144], [-8.2834, -2.8964, -1.4225], [-8.2834, -4.6906, -2.9144], [-8.2834, -1.1022, 0.069389], [-3.005, -4.5619, 6.062], [-2.8802, -6.4996, 4.7744], [-3.1298, -2.6242, 7.3496], [-0.25033, -5.4569, -6.062], [0.98961, -3.9627, -7.3496], [-1.4903, -6.9512, -4.7744], [-5.3144, -6.983, 1.4225], [-3.608, -7.5374, -0.069389], [-7.0208, -6.4285, 2.9144], [-5.3144, -6.983, -1.4225], [-3.608, -7.5374, -2.9144], [-7.0208, -6.4285, 0.069389], [0.19494, -8.7731, 1.4225], [1.9013, -9.3275, -0.069389], [-1.5114, -8.2186, 2.9144], [0.19494, -8.7731, -1.4225], [1.9013, -9.3275, -2.9144], [-1.5114, -8.2186, 0.069389], [3.41, -4.2676, 6.062], [5.2915, -4.7477, 4.7744], [1.5286, -3.7876, 7.3496], [5.1125, -1.9244, -6.062], [4.0745, -0.28336, -7.3496], [6.1505, -3.5654, -4.7744], [4.999, -7.2121, 1.4225], [6.0536, -5.7606, -0.069389], [3.9444, -8.6637, 2.9144], [4.999, -7.2121, -1.4225], [6.0536, -5.7606, -2.9144], [3.9444, -8.6637, 0.069389], [8.4039, -2.5256, 1.4225], [9.4585, -1.0741, -0.069389], [7.3493, -3.9772, 2.9144], [8.4039, -2.5256, -1.4225], [9.4585, -1.0741, -2.9144], [7.3493, -3.9772, 0.069389], [5.1125, 1.9244, 6.062], [6.1505, 3.5654, 4.7744], [4.0745, 0.28336, 7.3496], [3.41, 4.2676, -6.062], [1.5286, 3.7876, -7.3496], [5.2915, 4.7477, -4.7744], [8.4039, 2.5256, 1.4225], [7.3493, 3.9772, -0.069389], [9.4585, 1.0741, 2.9144], [8.4039, 2.5256, -1.4225], [7.3493, 3.9772, -2.9144], [9.4585, 1.0741, 0.069389], [4.999, 7.2121, -1.4225], [3.9444, 8.6637, -2.9144], [6.0536, 5.7606, 0.069389], [4.999, 7.2121, 1.4225], [3.9444, 8.6637, -0.069389], [6.0536, 5.7606, 2.9144], [-0.25033, 5.4569, 6.062], [-1.4903, 6.9512, 4.7744], [0.98961, 3.9627, 7.3496], [-3.005, 4.5619, -6.062], [-3.1298, 2.6242, -7.3496], [-2.8802, 6.4996, -4.7744], [0.19494, 8.7731, 1.4225], [-1.5114, 8.2186, -0.069389], [1.9013, 9.3275, 2.9144], [0.19494, 8.7731, -1.4225], [-1.5114, 8.2186, -2.9144], [1.9013, 9.3275, 0.069389], [-5.3144, 6.983, -1.4225], [-7.0208, 6.4285, -2.9144], [-3.608, 7.5374, 0.069389], [-5.3144, 6.983, 1.4225], [-7.0208, 6.4285, -0.069389], [-3.608, 7.5374, 2.9144]], 'unique_id': 'd68270ba4ceea04ceaea970174ad2e95', 'user': None}}, 'trans_time': 0.31090784072875977}, {'extract time': 0.030736923217773438, 'file_id': 'this-is-my-file-id', 'matio': {'ase': {'cell': [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], 'chemical_formula': 'Au144S60', 'ctime': 19.701231900650157, 'mtime': 19.701231900650157, 'numbers': [79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16], 'pbc': [False, False, False], 'positions': [[0.0, 0.0, -4.2675], [0.0, 0.0, -1.4225], [0.0, 0.0, 1.4225], [0.0, 0.0, 4.2675], [2.46384227377, 0.0, -5.69], [0.761369134053, 2.34325324959, -5.69], [-1.99329027094, 1.44821015249, -5.69], [-1.99329027094, -1.44821015249, -5.69], [0.761369134053, -2.34325324959, -5.69], [2.46384227377, 0.0, -2.845], [0.761369134053, 2.34325324959, -2.845], [-1.99329027094, 1.44821015249, -2.845], [-1.99329027094, -1.44821015249, -2.845], [0.761369134053, -2.34325324959, -2.845], [2.46384227377, 0.0, 0.0], [0.761369134053, 2.34325324959, 0.0], [-1.99329027094, 1.44821015249, 0.0], [-1.99329027094, -1.44821015249, 0.0], [0.761369134053, -2.34325324959, 0.0], [2.46384227377, 0.0, 2.845], [0.761369134053, 2.34325324959, 2.845], [-1.99329027094, 1.44821015249, 2.845], [-1.99329027094, -1.44821015249, 2.845], [0.761369134053, -2.34325324959, 2.845], [2.46384227377, 0.0, 5.69], [0.761369134053, 2.34325324959, 5.69], [-1.99329027094, 1.44821015249, 5.69], [-1.99329027094, -1.44821015249, 5.69], [0.761369134053, -2.34325324959, 5.69], [4.92768454753, 0.0, -4.2675], [3.22521140782, 2.34325324959, -4.2675], [1.52273826811, 4.68650649918, -4.2675], [-1.23192113688, 3.79146340208, -4.2675], [-3.98658054187, 2.89642030499, -4.2675], [-3.98658054187, 6.31716901012e-16, -4.2675], [-3.98658054187, -2.89642030499, -4.2675], [-1.23192113688, -3.79146340208, -4.2675], [1.52273826811, -4.68650649918, -4.2675], [3.22521140782, -2.34325324959, -4.2675], [4.92768454753, 0.0, -1.4225], [3.22521140782, 2.34325324959, -1.4225], [1.52273826811, 4.68650649918, -1.4225], [-1.23192113688, 3.79146340208, -1.4225], [-3.98658054187, 2.89642030499, -1.4225], [-3.98658054187, 6.31716901012e-16, -1.4225], [-3.98658054187, -2.89642030499, -1.4225], [-1.23192113688, -3.79146340208, -1.4225], [1.52273826811, -4.68650649918, -1.4225], [3.22521140782, -2.34325324959, -1.4225], [4.92768454753, 0.0, 1.4225], [3.22521140782, 2.34325324959, 1.4225], [1.52273826811, 4.68650649918, 1.4225], [-1.23192113688, 3.79146340208, 1.4225], [-3.98658054187, 2.89642030499, 1.4225], [-3.98658054187, 6.31716901012e-16, 1.4225], [-3.98658054187, -2.89642030499, 1.4225], [-1.23192113688, -3.79146340208, 1.4225], [1.52273826811, -4.68650649918, 1.4225], [3.22521140782, -2.34325324959, 1.4225], [4.92768454753, 0.0, 4.2675], [3.22521140782, 2.34325324959, 4.2675], [1.52273826811, 4.68650649918, 4.2675], [-1.23192113688, 3.79146340208, 4.2675], [-3.98658054187, 2.89642030499, 4.2675], [-3.98658054187, 6.31716901012e-16, 4.2675], [-3.98658054187, -2.89642030499, 4.2675], [-1.23192113688, -3.79146340208, 4.2675], [1.52273826811, -4.68650649918, 4.2675], [3.22521140782, -2.34325324959, 4.2675], [7.3915268213, 0.0, -2.845], [5.68905368159, 2.34325324959, -2.845], [3.98658054187, 4.68650649918, -2.845], [2.28410740216, 7.02975974877, -2.845], [-0.47055200283, 6.13471665167, -2.845], [-3.22521140782, 5.23967355458, -2.845], [-5.97987081281, 4.34463045748, -2.845], [-5.97987081281, 1.44821015249, -2.845], [-5.97987081281, -1.44821015249, -2.845], [-5.97987081281, -4.34463045748, -2.845], [-3.22521140782, -5.23967355458, -2.845], [-0.47055200283, -6.13471665167, -2.845], [2.28410740216, -7.02975974877, -2.845], [3.98658054187, -4.68650649918, -2.845], [5.68905368159, -2.34325324959, -2.845], [7.3915268213, 0.0, 0.0], [5.68905368159, 2.34325324959, 0.0], [3.98658054187, 4.68650649918, 0.0], [2.28410740216, 7.02975974877, 0.0], [-0.47055200283, 6.13471665167, 0.0], [-3.22521140782, 5.23967355458, 0.0], [-5.97987081281, 4.34463045748, 0.0], [-5.97987081281, 1.44821015249, 0.0], [-5.97987081281, -1.44821015249, 0.0], [-5.97987081281, -4.34463045748, 0.0], [-3.22521140782, -5.23967355458, 0.0], [-0.47055200283, -6.13471665167, 0.0], [2.28410740216, -7.02975974877, 0.0], [3.98658054187, -4.68650649918, 0.0], [5.68905368159, -2.34325324959, 0.0], [7.3915268213, 0.0, 2.845], [5.68905368159, 2.34325324959, 2.845], [3.98658054187, 4.68650649918, 2.845], [2.28410740216, 7.02975974877, 2.845], [-0.47055200283, 6.13471665167, 2.845], [-3.22521140782, 5.23967355458, 2.845], [-5.97987081281, 4.34463045748, 2.845], [-5.97987081281, 1.44821015249, 2.845], [-5.97987081281, -1.44821015249, 2.845], [-5.97987081281, -4.34463045748, 2.845], [-3.22521140782, -5.23967355458, 2.845], [-0.47055200283, -6.13471665167, 2.845], [2.28410740216, -7.02975974877, 2.845], [3.98658054187, -4.68650649918, 2.845], [5.68905368159, -2.34325324959, 2.845], [-5.2672, 1.4482, 6.062], [-7.0715, 0.73071, 4.7744], [-3.4629, 2.1657, 7.3496], [-5.2672, -1.4482, -6.062], [-3.4629, -2.1657, -7.3496], [-7.0715, -0.73071, -4.7744], [-8.2834, 2.8964, 1.4225], [-8.2834, 1.1022, -0.069389], [-8.2834, 4.6906, 2.9144], [-8.2834, 2.8964, -1.4225], [-8.2834, 1.1022, -2.9144], [-8.2834, 4.6906, 0.069389], [-8.2834, -2.8964, 1.4225], [-8.2834, -4.6906, -0.069389], [-8.2834, -1.1022, 2.9144], [-8.2834, -2.8964, -1.4225], [-8.2834, -4.6906, -2.9144], [-8.2834, -1.1022, 0.069389], [-3.005, -4.5619, 6.062], [-2.8802, -6.4996, 4.7744], [-3.1298, -2.6242, 7.3496], [-0.25033, -5.4569, -6.062], [0.98961, -3.9627, -7.3496], [-1.4903, -6.9512, -4.7744], [-5.3144, -6.983, 1.4225], [-3.608, -7.5374, -0.069389], [-7.0208, -6.4285, 2.9144], [-5.3144, -6.983, -1.4225], [-3.608, -7.5374, -2.9144], [-7.0208, -6.4285, 0.069389], [0.19494, -8.7731, 1.4225], [1.9013, -9.3275, -0.069389], [-1.5114, -8.2186, 2.9144], [0.19494, -8.7731, -1.4225], [1.9013, -9.3275, -2.9144], [-1.5114, -8.2186, 0.069389], [3.41, -4.2676, 6.062], [5.2915, -4.7477, 4.7744], [1.5286, -3.7876, 7.3496], [5.1125, -1.9244, -6.062], [4.0745, -0.28336, -7.3496], [6.1505, -3.5654, -4.7744], [4.999, -7.2121, 1.4225], [6.0536, -5.7606, -0.069389], [3.9444, -8.6637, 2.9144], [4.999, -7.2121, -1.4225], [6.0536, -5.7606, -2.9144], [3.9444, -8.6637, 0.069389], [8.4039, -2.5256, 1.4225], [9.4585, -1.0741, -0.069389], [7.3493, -3.9772, 2.9144], [8.4039, -2.5256, -1.4225], [9.4585, -1.0741, -2.9144], [7.3493, -3.9772, 0.069389], [5.1125, 1.9244, 6.062], [6.1505, 3.5654, 4.7744], [4.0745, 0.28336, 7.3496], [3.41, 4.2676, -6.062], [1.5286, 3.7876, -7.3496], [5.2915, 4.7477, -4.7744], [8.4039, 2.5256, 1.4225], [7.3493, 3.9772, -0.069389], [9.4585, 1.0741, 2.9144], [8.4039, 2.5256, -1.4225], [7.3493, 3.9772, -2.9144], [9.4585, 1.0741, 0.069389], [4.999, 7.2121, -1.4225], [3.9444, 8.6637, -2.9144], [6.0536, 5.7606, 0.069389], [4.999, 7.2121, 1.4225], [3.9444, 8.6637, -0.069389], [6.0536, 5.7606, 2.9144], [-0.25033, 5.4569, 6.062], [-1.4903, 6.9512, 4.7744], [0.98961, 3.9627, 7.3496], [-3.005, 4.5619, -6.062], [-3.1298, 2.6242, -7.3496], [-2.8802, 6.4996, -4.7744], [0.19494, 8.7731, 1.4225], [-1.5114, 8.2186, -0.069389], [1.9013, 9.3275, 2.9144], [0.19494, 8.7731, -1.4225], [-1.5114, 8.2186, -2.9144], [1.9013, 9.3275, 0.069389], [-5.3144, 6.983, -1.4225], [-7.0208, 6.4285, -2.9144], [-3.608, 7.5374, 0.069389], [-5.3144, 6.983, 1.4225], [-7.0208, 6.4285, -0.069389], [-3.608, 7.5374, 2.9144]], 'unique_id': '65cbfab76d24f98f2b4b8463e1a7d1ab', 'user': None}}, 'trans_time': 0.3621675968170166}, {'extract time': 0.010744094848632812, 'file_id': 'this-is-my-file-id', 'matio': {'ase': {'cell': [[0.0, 0.0, 0.0], [0.0, 0.0, 0.0], [0.0, 0.0, 0.0]], 'chemical_formula': 'Au144S60', 'ctime': 19.70123191506556, 'mtime': 19.70123191506556, 'numbers': [79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16, 79, 16, 16], 'pbc': [False, False, False], 'positions': [[0.0, 0.0, -4.2675], [0.0, 0.0, -1.4225], [0.0, 0.0, 1.4225], [0.0, 0.0, 4.2675], [2.46384227377, 0.0, -5.69], [0.761369134053, 2.34325324959, -5.69], [-1.99329027094, 1.44821015249, -5.69], [-1.99329027094, -1.44821015249, -5.69], [0.761369134053, -2.34325324959, -5.69], [2.46384227377, 0.0, -2.845], [0.761369134053, 2.34325324959, -2.845], [-1.99329027094, 1.44821015249, -2.845], [-1.99329027094, -1.44821015249, -2.845], [0.761369134053, -2.34325324959, -2.845], [2.46384227377, 0.0, 0.0], [0.761369134053, 2.34325324959, 0.0], [-1.99329027094, 1.44821015249, 0.0], [-1.99329027094, -1.44821015249, 0.0], [0.761369134053, -2.34325324959, 0.0], [2.46384227377, 0.0, 2.845], [0.761369134053, 2.34325324959, 2.845], [-1.99329027094, 1.44821015249, 2.845], [-1.99329027094, -1.44821015249, 2.845], [0.761369134053, -2.34325324959, 2.845], [2.46384227377, 0.0, 5.69], [0.761369134053, 2.34325324959, 5.69], [-1.99329027094, 1.44821015249, 5.69], [-1.99329027094, -1.44821015249, 5.69], [0.761369134053, -2.34325324959, 5.69], [4.92768454753, 0.0, -4.2675], [3.22521140782, 2.34325324959, -4.2675], [1.52273826811, 4.68650649918, -4.2675], [-1.23192113688, 3.79146340208, -4.2675], [-3.98658054187, 2.89642030499, -4.2675], [-3.98658054187, 6.31716901012e-16, -4.2675], [-3.98658054187, -2.89642030499, -4.2675], [-1.23192113688, -3.79146340208, -4.2675], [1.52273826811, -4.68650649918, -4.2675], [3.22521140782, -2.34325324959, -4.2675], [4.92768454753, 0.0, -1.4225], [3.22521140782, 2.34325324959, -1.4225], [1.52273826811, 4.68650649918, -1.4225], [-1.23192113688, 3.79146340208, -1.4225], [-3.98658054187, 2.89642030499, -1.4225], [-3.98658054187, 6.31716901012e-16, -1.4225], [-3.98658054187, -2.89642030499, -1.4225], [-1.23192113688, -3.79146340208, -1.4225], [1.52273826811, -4.68650649918, -1.4225], [3.22521140782, -2.34325324959, -1.4225], [4.92768454753, 0.0, 1.4225], [3.22521140782, 2.34325324959, 1.4225], [1.52273826811, 4.68650649918, 1.4225], [-1.23192113688, 3.79146340208, 1.4225], [-3.98658054187, 2.89642030499, 1.4225], [-3.98658054187, 6.31716901012e-16, 1.4225], [-3.98658054187, -2.89642030499, 1.4225], [-1.23192113688, -3.79146340208, 1.4225], [1.52273826811, -4.68650649918, 1.4225], [3.22521140782, -2.34325324959, 1.4225], [4.92768454753, 0.0, 4.2675], [3.22521140782, 2.34325324959, 4.2675], [1.52273826811, 4.68650649918, 4.2675], [-1.23192113688, 3.79146340208, 4.2675], [-3.98658054187, 2.89642030499, 4.2675], [-3.98658054187, 6.31716901012e-16, 4.2675], [-3.98658054187, -2.89642030499, 4.2675], [-1.23192113688, -3.79146340208, 4.2675], [1.52273826811, -4.68650649918, 4.2675], [3.22521140782, -2.34325324959, 4.2675], [7.3915268213, 0.0, -2.845], [5.68905368159, 2.34325324959, -2.845], [3.98658054187, 4.68650649918, -2.845], [2.28410740216, 7.02975974877, -2.845], [-0.47055200283, 6.13471665167, -2.845], [-3.22521140782, 5.23967355458, -2.845], [-5.97987081281, 4.34463045748, -2.845], [-5.97987081281, 1.44821015249, -2.845], [-5.97987081281, -1.44821015249, -2.845], [-5.97987081281, -4.34463045748, -2.845], [-3.22521140782, -5.23967355458, -2.845], [-0.47055200283, -6.13471665167, -2.845], [2.28410740216, -7.02975974877, -2.845], [3.98658054187, -4.68650649918, -2.845], [5.68905368159, -2.34325324959, -2.845], [7.3915268213, 0.0, 0.0], [5.68905368159, 2.34325324959, 0.0], [3.98658054187, 4.68650649918, 0.0], [2.28410740216, 7.02975974877, 0.0], [-0.47055200283, 6.13471665167, 0.0], [-3.22521140782, 5.23967355458, 0.0], [-5.97987081281, 4.34463045748, 0.0], [-5.97987081281, 1.44821015249, 0.0], [-5.97987081281, -1.44821015249, 0.0], [-5.97987081281, -4.34463045748, 0.0], [-3.22521140782, -5.23967355458, 0.0], [-0.47055200283, -6.13471665167, 0.0], [2.28410740216, -7.02975974877, 0.0], [3.98658054187, -4.68650649918, 0.0], [5.68905368159, -2.34325324959, 0.0], [7.3915268213, 0.0, 2.845], [5.68905368159, 2.34325324959, 2.845], [3.98658054187, 4.68650649918, 2.845], [2.28410740216, 7.02975974877, 2.845], [-0.47055200283, 6.13471665167, 2.845], [-3.22521140782, 5.23967355458, 2.845], [-5.97987081281, 4.34463045748, 2.845], [-5.97987081281, 1.44821015249, 2.845], [-5.97987081281, -1.44821015249, 2.845], [-5.97987081281, -4.34463045748, 2.845], [-3.22521140782, -5.23967355458, 2.845], [-0.47055200283, -6.13471665167, 2.845], [2.28410740216, -7.02975974877, 2.845], [3.98658054187, -4.68650649918, 2.845], [5.68905368159, -2.34325324959, 2.845], [-5.2672, 1.4482, 6.062], [-7.0715, 0.73071, 4.7744], [-3.4629, 2.1657, 7.3496], [-5.2672, -1.4482, -6.062], [-3.4629, -2.1657, -7.3496], [-7.0715, -0.73071, -4.7744], [-8.2834, 2.8964, 1.4225], [-8.2834, 1.1022, -0.069389], [-8.2834, 4.6906, 2.9144], [-8.2834, 2.8964, -1.4225], [-8.2834, 1.1022, -2.9144], [-8.2834, 4.6906, 0.069389], [-8.2834, -2.8964, 1.4225], [-8.2834, -4.6906, -0.069389], [-8.2834, -1.1022, 2.9144], [-8.2834, -2.8964, -1.4225], [-8.2834, -4.6906, -2.9144], [-8.2834, -1.1022, 0.069389], [-3.005, -4.5619, 6.062], [-2.8802, -6.4996, 4.7744], [-3.1298, -2.6242, 7.3496], [-0.25033, -5.4569, -6.062], [0.98961, -3.9627, -7.3496], [-1.4903, -6.9512, -4.7744], [-5.3144, -6.983, 1.4225], [-3.608, -7.5374, -0.069389], [-7.0208, -6.4285, 2.9144], [-5.3144, -6.983, -1.4225], [-3.608, -7.5374, -2.9144], [-7.0208, -6.4285, 0.069389], [0.19494, -8.7731, 1.4225], [1.9013, -9.3275, -0.069389], [-1.5114, -8.2186, 2.9144], [0.19494, -8.7731, -1.4225], [1.9013, -9.3275, -2.9144], [-1.5114, -8.2186, 0.069389], [3.41, -4.2676, 6.062], [5.2915, -4.7477, 4.7744], [1.5286, -3.7876, 7.3496], [5.1125, -1.9244, -6.062], [4.0745, -0.28336, -7.3496], [6.1505, -3.5654, -4.7744], [4.999, -7.2121, 1.4225], [6.0536, -5.7606, -0.069389], [3.9444, -8.6637, 2.9144], [4.999, -7.2121, -1.4225], [6.0536, -5.7606, -2.9144], [3.9444, -8.6637, 0.069389], [8.4039, -2.5256, 1.4225], [9.4585, -1.0741, -0.069389], [7.3493, -3.9772, 2.9144], [8.4039, -2.5256, -1.4225], [9.4585, -1.0741, -2.9144], [7.3493, -3.9772, 0.069389], [5.1125, 1.9244, 6.062], [6.1505, 3.5654, 4.7744], [4.0745, 0.28336, 7.3496], [3.41, 4.2676, -6.062], [1.5286, 3.7876, -7.3496], [5.2915, 4.7477, -4.7744], [8.4039, 2.5256, 1.4225], [7.3493, 3.9772, -0.069389], [9.4585, 1.0741, 2.9144], [8.4039, 2.5256, -1.4225], [7.3493, 3.9772, -2.9144], [9.4585, 1.0741, 0.069389], [4.999, 7.2121, -1.4225], [3.9444, 8.6637, -2.9144], [6.0536, 5.7606, 0.069389], [4.999, 7.2121, 1.4225], [3.9444, 8.6637, -0.069389], [6.0536, 5.7606, 2.9144], [-0.25033, 5.4569, 6.062], [-1.4903, 6.9512, 4.7744], [0.98961, 3.9627, 7.3496], [-3.005, 4.5619, -6.062], [-3.1298, 2.6242, -7.3496], [-2.8802, 6.4996, -4.7744], [0.19494, 8.7731, 1.4225], [-1.5114, 8.2186, -0.069389], [1.9013, 9.3275, 2.9144], [0.19494, 8.7731, -1.4225], [-1.5114, 8.2186, -2.9144], [1.9013, 9.3275, 0.069389], [-5.3144, 6.983, -1.4225], [-7.0208, 6.4285, -2.9144], [-3.608, 7.5374, 0.069389], [-5.3144, 6.983, 1.4225], [-7.0208, 6.4285, -0.069389], [-3.608, 7.5374, 2.9144]], 'unique_id': 'f60c2e82ee3675c1d68d8fa3e2df0a94', 'user': None}}, 'trans_time': 0.4429779052734375}], 'tot_time': 1.5505785942077637}}, 'status': 'SUCCEEDED', 'task_id': '748ee35a-9f87-44c4-9698-5790b0f99ed8'}
    func_id = fxc.register_function("sleep_60", func, "sleep_60",
                                      description="A sleep function",
                                      container=container_uuid)

    res_list = {}
    payload = {'headers': headers}
    for i in range(0, num_run):
        print("Running function. ")
        res = fxc.run(payload, ep_id, func_id, asynchronous=True)
        res_list[res] = 1

    # while True:
    #     for res in res_list:
    #         print(fxc.get_task_status(res))
    #     time.sleep(2)

    return res_list

def pack_and_run_batch(run_type, headers, batch_size, num_run):

    # endpoint_uuid = '3cc6d6ce-9a60-4559-bf21-1a3d2ce5da20'
    endpoint_uuid = 'a92945a1-2778-4417-8cd1-4957bc35ce66'

    if run_type == 'images':
        file_path = image_file
        func_id = image_func
    elif run_type == 'sampler':
        file_path = sampler_file
        func_id = sampler_func
    elif run_type == 'keyword':
        file_path = freetext_file
        func_id = freetext_func
    elif run_type == 'matio':
        file_path = matio_file
        func_id = matio_func
    else:
        raise TypeError("Invalid run type.")

    # STEP 1. Warm the containers
    res_list = warm_containers(endpoint_uuid,run_type, num_run, get_headers())

    # STEP 2. Prepare the batched functions.

    data = {'inputs': []}


    for i in range(0, batch_size):
        payload = {'url': 'https://e38ee745-6d04-11e5-ba46-22000b92c6ec.e.globus.org' + file_path,
                   'headers': headers, 'file_id':  str(random.randint(10000,99999))}
        data['inputs'].append(payload)

    # STEP 3. Iterate through warming containers list. If successful, replace with actual task (then remove from res_list.
    total_times = []
    start_time_dict = {}
    invoke_list = {}
    while True:
        del_list = []
        for res in res_list:
            status = fxc.get_task_status(res)
            # print("Warming status: {}".format(status["status"]))

            if status['status'] == 'SUCCEEDED':
                # PUT ACTUAL FUNCTION ONTO THE QUEUE.

                print("Invoking function...")
                t0 = time.time()
                new_invoke = fxc.run(data, endpoint_uuid, func_id, asynchronous=True)
                invoke_list[new_invoke] = 1

                start_time_dict[new_invoke] = t0
                del_list.append(res)

        for res in del_list:
            del res_list[res]

        del_list_2 = []
        for inv_id in invoke_list:
            status = fxc.get_task_status(inv_id)

            print("Actual function status: {}".format(status["status"]))

            if status["status"] == "SUCCEEDED":

                print(status)

                t1 = time.time()

                total_time = t1-start_time_dict[inv_id]
                print("Total Time: {}".format(total_time))
                total_times.append(total_time)

                del_list_2.append(inv_id)

        for res in del_list_2:
            del invoke_list[res]

        if len(total_times) > 0:
            time.sleep(0.1)
            print(mean(total_times))

        # if len(invoke_list)

mean_time = pack_and_run_batch('keyword', get_headers(), 256, num_run=40)
# rint("MEAN TIME: {}".format(mean_time))
# warm_containers('3cc6d6ce-9a60-4559-bf21-1a3d2ce5da20', 'images', 7, get_headers())
